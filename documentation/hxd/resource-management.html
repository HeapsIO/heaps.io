<!DOCTYPE html>
<html lang="en" id="page"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width"/><title>Resource management - Hxd  - Heaps.io Game Engine</title><base href="./../.."/>
<link href="css/styles.css" rel="stylesheet" type="text/css"/><link rel="canonical" href="http://heaps.io/documentation/hxd/resource-management.html"/><meta name="description" content="Heaps provides a complete asset/resource management framework that can be customized with your own asset packaging system."/>
<meta name="twitter:creator" content="@ncanasse"/>
<meta property="og:title" content="Resource management - Hxd  - Heaps.io Game Engine"/><meta property="og:description" content="Heaps provides a complete asset/resource management framework that can be customized with your own asset packaging system."/><meta property="og:type" content="website"/><meta property="og:url" content="http://heaps.io/documentation/hxd/resource-management.html"/><meta property="og:image" content="http://heaps.io//img/share.png"/>    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en"/></head><body><main><header class="header-documentation"><nav class="top-nav"><a href="./" class="button ">Home</a><a href="about.html" class="button ">About</a><a href="samples/" class="button ">Samples</a><a href="documentation/" class="button disabled">Online handbook</a><a href="api/" class="button">API</a><a href="https://github.com/HeapsIO/heaps/" class="button"><svg aria-hidden="true" width="20" height="20" version="1.1" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg> Source</a></nav></header> <div class="row container"><nav class="col-4 sidebar"><ul class="unstyled"><li><a href="documentation/getting-started/">Getting started</a></li><li><a href="documentation/h2d/">H2d</a></li><li><a href="documentation/h3d/">H3d</a></li><li class="active"><a href="documentation/hxd/">Hxd</a><ul><li class="current"><a href="documentation/hxd/resource-management.html">Resource management</a></li><li><a href="documentation/hxd/sound.html">Sound</a></li></ul></li><li><a href="documentation/other/">Other</a></li><li><a href="documentation/shaders/">Shaders</a></li><li><a href="documentation/tools/">Tools</a></li></ul></nav><article class="col-8 documentation"><div class="content"><h1><span>Hxd</span> Resource management </h1><p>Heaps provides a complete asset/resource management framework that can be customized with your own asset packaging system.</p>
<h2>Getting Started</h2>
<p>You can directly access your resources in a typed manner in Heaps by using the <code>hxd.Res</code> class, for instance by doing:</p>
<pre><code class="prettyprint haxe">var tile = hxd.Res.myDirectory.myBitmap.toTile();</code></pre>
<p>Please note that this is strictly typed: hxd.Res will look into the <code>res</code> directory of your project (or the directory specified by <code>-D resourcePath=...</code> haxe compilation parameter). It will then list all directories and files, and depending on the file extension, it will provide you access to the following resources:</p><ul><li><code>png,jpg,jpeg,gif</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Image.hx">hxd.res.Image</a></li><li><code>wav,mp3,ogg</code> : <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Sound.hx">hxd.res.Sound</a></li><li><code>fbx,hmd</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Model.hx">hxd.res.Model</a></li><li><code>fnt</code> (+png): <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/BitmapFont.hx">hxd.res.BitmapFont</a></li><li><code>ttf</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Font.hx">hxd.res.Font</a></li><li><code>tmx</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/TiledMap.hx">hxd.res.TiledMap</a></li><li><code>atlas</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Atlas.hx">hxd.res.Atlas</a></li><li>other: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Resource.hx">hxd.res.Resource</a> (still allows you to ready binary data)</li></ul>
<h2>Resources loader</h2>
<p>The <code>hxd.Res</code> provides your strictly typed shortcuts to access your resources, but it does not take care of the resource loading. For this, you need to initialize a resource loader before accessing your first resource, for instance:</p>
<pre><code class="prettyprint haxe">hxd.Res.initEmbed();</code></pre>
<p>This will be the same as writing:</p>
<pre><code class="prettyprint haxe">hxd.Res.loader = new hxd.res.Loader(hxd.fs.EmbedFileSystem.create());</code></pre>
<p>A loader will cache the resources instances after they have been fetched from the underlying file system. There are several ways to store your resources.</p>
<h3>Dynamic resource resolution</h3>
<p>You can resolve a resource from it path in the resource file system by using the following command:</p>
<pre><code class="prettyprint haxe">hxd.Res.loader.load("path/to/myResource.png")</code></pre>
<p>This will return a <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Any.hx">hxd.res.Any</a> which have various methods to transform it to other resources.</p>
<h3>Runtime resource loading</h3>
<p>You can also perform you own runtime loading of resources, by using for example <code>hxd.net.BinaryLoader</code>.
Once you have the bytes for your resource, you can use <code>hxd.res.Any.fromBytes</code> to transform it into a proper resource.</p>
<h2>File Systems</h2>
<p>Resources files are accessed through a virtual file system which implements the <a href="https://github.com/ncannasse/heaps/blob/master/hxd/fs/FileSystem.hx">FileSystem</a> interface. </p>
<p>Heaps provides already several file systems, such as:
<em> <a href="https://github.com/ncannasse/heaps/blob/master/hxd/fs/EmbedFileSystem.hx">EmbedFileSystem</a> will gives access to the resources which are embedded with your code (using haxe <code>-resource</code> compilation flag). On platforms such as JavaScript, this allows you to have both your code and assets stored in a single file.
</em> <a href="https://github.com/ncannasse/heaps/blob/master/hxd/fs/LocalFileSystem.hx">LocalFileSystem</a> which gives access to a local file system directory where your resources are stored. This require hard drive access so it is not available in the browser for example.
* <a href="https://github.com/ncannasse/heaps/blob/master/hxd/fmt/pak/FileSystem.hx">hxd.fmt.pak.FileSystem</a> will read a <code>.pak</code> file which contains all resources packaged into a single binary. The PAK file can be loaded at runtime and several PAK files can be used, the latest loaded being able to override the resources declared in previously loaded PAK files.  </p>
<p>You can initialize the resource loader and filesystem by yourself, or use one of the following shortcuts:
<em> <code>hxd.Res.initEmbed()</code> for EmbedFileSystem - this will also trigger the embedding of all files present in your resource directory into your code
</em> <code>hxd.Res.initLocal()</code> for LocalFileSystem
* <code>hxd.Res.initPak()</code> for PAK FileSystem - this will load res.pak, res1.pak, res2.pak, etc. from the local filesystem - until no file is found.</p>
<h2>Building PAK</h2>
<p>You can build a <code>pak</code> file for all your ressources by running the following command from your project directory:</p>
<pre><code>haxelib run heaps pak</code></pre>
<h2>PAK Loader</h2>
<p>If you want to load your PAK file(s) with a progress bar showing, you can override the <code>loadAssets</code> method of your <code>hxd.App</code> class with the following code:</p>
<pre><code class="prettyprint haxe">override function loadAssets(done) {
    new hxd.fmt.pak.Loader(s2d, done);
}</code></pre>
<p>This will be called before <code>init()</code>, and while loading <code>update()</code> and <code>onResize</code> will not be called.</p></div></article> </div></main><footer><div class="container"><div class="lead"><p>Follow <a href="https://github.com/HeapsIO/">Heaps.io on Github</a>: <br/><a class="github-button" href="https://github.com/HeapsIO/heaps/issues" data-icon="octicon-issue-opened" data-style="mega" data-count-api="/repos/HeapsIO/heaps#open_issues_count" data-count-aria-label="# issues on GitHub" aria-label="Issue HeapsIO/heaps on GitHub">Issue</a> &nbsp; <a class="github-button" href="https://github.com/HeapsIO/heaps" data-icon="octicon-star" data-style="mega" data-count-href="/HeapsIO/heaps/stargazers" data-count-api="/repos/HeapsIO/heaps#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star HeapsIO/heaps on GitHub">Star</a></p></div></div></footer><script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" type="text/css" href="http://code.haxe.org/css/highlighter.min.css"/><script defer="defer" src="http://code.haxe.org/js/highlighter.js"></script></body></html>