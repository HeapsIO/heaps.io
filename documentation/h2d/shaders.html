<!DOCTYPE html>
<html lang="en" id="page"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width"/><title>Shaders - H2d  - Heaps.io Game Engine</title><base href="./../.."/>
<link href="css/styles.css" rel="stylesheet" type="text/css"/><link rel="canonical" href="http://heaps.io/documentation/h2d/shaders.html"/><meta name="description" content="You can add a Shader in H2D using drawable.addShader."/>
<meta name="twitter:creator" content="@ncanasse"/>
<meta property="og:title" content="Shaders - H2d  - Heaps.io Game Engine"/><meta property="og:description" content="You can add a Shader in H2D using drawable.addShader."/><meta property="og:type" content="website"/><meta property="og:url" content="http://heaps.io/documentation/h2d/shaders.html"/><meta property="og:image" content="http://heaps.io//img/share.png"/>    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en"/></head><body><main><header class="header-documentation"><nav class="top-nav"><a href="./" class="button ">Home</a><a href="about.html" class="button ">About</a><a href="samples/" class="button ">Samples</a><a href="documentation/getting-started/" class="button disabled">Online handbook</a><a href="api/" class="button">API</a><a href="https://gitter.im/heapsio/Lobby" class="button" target="_blank">Community</a><a href="https://github.com/HeapsIO/heaps.io/" class="button" target="_blank"><svg aria-hidden="true" width="20" height="20" version="1.1" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg> Source</a></nav></header> <div class="row container"><nav class="col-4 sidebar"><ul class="unstyled"><li><a href="documentation/getting-started/">Getting started</a></li><li class="active"><a href="documentation/h2d/">H2d</a><ul><li><a href="documentation/h2d/1.introduction.html">Introduction</a></li><li><a href="documentation/h2d/animation.html">Animation</a></li><li><a href="documentation/h2d/displaying-text.html">Displaying text</a></li><li><a href="documentation/h2d/drawable.html">Drawable</a></li><li><a href="documentation/h2d/drawing-tiles.html">Drawing tiles</a></li><li><a href="documentation/h2d/events-and-interactivity.html">Events and interaction</a></li><li><a href="documentation/h2d/filters.html">Filters</a></li><li><a href="documentation/h2d/layers.html">Layers</a></li><li><a href="documentation/h2d/optimizing-bitmap-usage.html">Optimizing bitmaps</a></li><li class="current"><a href="documentation/h2d/shaders.html">Shaders</a></li><li><a href="documentation/h2d/sprite-properties.html">Sprites</a></li></ul></li><li><a href="documentation/h3d/">H3d</a></li><li><a href="documentation/hxd/">Hxd</a></li><li><a href="documentation/other/">Other</a></li><li><a href="documentation/shaders/">Shaders</a></li><li><a href="documentation/tools/">Tools</a></li></ul></nav><article class="col-8 documentation"><div class="content"><h1><span>H2d</span> Shaders </h1><p>You can add a Shader in H2D using <code>drawable.addShader</code>.</p>
<pre><code class="prettyprint haxe">var bmp = new Bitmap(hxd.Res.my_image.toTile());
var shader = new SineDeformShader();
shader.speed = 1;
shader.amplitude = .1;
shader.frequency = .5;
shader.texture = bmp.tile.getTexture();
bmp.addShader(shader);</code></pre>
<h2>Creating custom shaders</h2>
<p>To create a custom shader, extend <code>hxsl.Shader</code> and write the shader source in static <code>SRC</code>.
You also need to add <code>@:import h3d.shader.Base2d;</code>, which exposes helpful parameters (see next section).</p>
<pre><code class="prettyprint haxe">class SineDeformShader extends hxsl.Shader {
	static var SRC = {
		@:import h3d.shader.Base2d;
		
		@param var texture : Sampler2D;
		@param var speed : Float;
		@param var frequency : Float;
		@param var amplitude : Float;
		
		function fragment() {
			calculatedUV.y += sin(calculatedUV.y * frequency + time * speed) * amplitude; // wave deform
			pixelColor = texture2D(texture, calculatedUV);
		}
	}
}</code></pre>
<h3>Base 2D values</h3>
<p>For 2D shaders, the following parameters are available. 
When in doubt, can look these up in <code>h3d.shader.Base2d</code> (which you have to import).</p>
<pre><code class="prettyprint haxe">@input var input : {
	var position : Vec2;
	var uv : Vec2;
	var color : Vec4;
};

var output : {
	var position : Vec4;
	var color : Vec4;
};

@global var time : Float;
@param var zValue : Float;
@param var texture : Sampler2D;

var spritePosition : Vec4;
var absolutePosition : Vec4;
var pixelColor : Vec4;
var textureColor : Vec4;
@var var calculatedUV : Vec2;

@const var isRelative : Bool;
@param var color : Vec4;
@param var absoluteMatrixA : Vec3;
@param var absoluteMatrixB : Vec3;
@param var filterMatrixA : Vec3;
@param var filterMatrixB : Vec3;
@const var hasUVPos : Bool;
@param var uvPos : Vec4;

@const var killAlpha : Bool;
@const var pixelAlign : Bool;
@param var halfPixelInverse : Vec2;
@param var viewport : Vec4;

var outputPosition : Vec4;</code></pre><hr/><div class="contribution"><span class="contribution-link"><svg width="16" height="16" viewBox="0 0 1024 1024"><path fill="#222" d="M978.101 45.898c-28.77-28.768-67.018-44.611-107.701-44.611-40.685 0-78.933 15.843-107.701 44.611l-652.8 652.8c-2.645 2.645-4.678 5.837-5.957 9.354l-102.4 281.6c-3.4 9.347-1.077 19.818 5.957 26.85 4.885 4.888 11.43 7.499 18.104 7.499 2.933 0 5.891-0.502 8.744-1.541l281.6-102.4c3.515-1.28 6.709-3.312 9.354-5.958l652.8-652.8c28.768-28.768 44.613-67.018 44.613-107.702s-15.843-78.933-44.613-107.701zM293.114 873.883l-224.709 81.71 81.712-224.707 566.683-566.683 142.997 142.997-566.683 566.683zM941.899 225.098l-45.899 45.899-142.997-142.997 45.899-45.899c19.098-19.098 44.49-29.614 71.498-29.614s52.4 10.518 71.499 29.616c19.098 19.098 29.616 44.49 29.616 71.498s-10.52 52.4-29.616 71.498z"></path></svg> <a href="https://github.com/HeapsIO/heaps.io/edit/master/./assets/content/documentation/H2d/Shaders.md?message=Update:%20Shaders&description=%0A%0ASources:%0A*%20http://heaps.io/documentation/h2d/shaders.html" rel="external">Edit Page</a></span> <span class="contribution-link"><svg width="16" height="16" viewBox="0 0 1024 1024"><path fill="#222" d="M896 614.4h-77.544c-3.19-56.282-16.878-110.243-39.965-158.814 53.056-15.624 91.909-64.739 91.909-122.786 0-14.138-11.461-25.6-25.6-25.6s-25.6 11.462-25.6 25.6c0 38.984-29.205 71.254-66.88 76.138-8.928-13.632-18.678-26.68-29.259-39.026-5.515-6.435-11.203-12.6-17.032-18.525 7.147-22.477 10.771-45.877 10.771-69.787 0-127.043-103.357-230.4-230.4-230.4s-230.4 103.357-230.4 230.4c0 23.909 3.624 47.309 10.77 69.787-5.829 5.923-11.515 12.090-17.032 18.525-10.582 12.346-20.331 25.394-29.259 39.026-37.674-4.883-66.878-37.154-66.878-76.138 0-14.138-11.462-25.6-25.6-25.6s-25.6 11.462-25.6 25.6c0 58.046 38.853 107.162 91.907 122.784-23.086 48.573-36.773 102.534-39.965 158.816h-77.542c-14.138 0-25.6 11.461-25.6 25.6s11.462 25.6 25.6 25.6h77.544c3.19 56.283 16.878 110.243 39.965 158.816-53.056 15.622-91.909 64.738-91.909 122.784 0 14.139 11.462 25.6 25.6 25.6s25.6-11.461 25.6-25.6c0-38.984 29.205-71.254 66.88-76.138 8.928 13.632 18.677 26.68 29.259 39.026 62.965 73.458 147.013 113.912 236.661 113.912s173.698-40.454 236.661-113.912c10.581-12.346 20.331-25.394 29.258-39.026 37.677 4.883 66.882 37.152 66.882 76.138 0 14.139 11.461 25.6 25.6 25.6s25.6-11.461 25.6-25.6c0-58.046-38.853-107.163-91.907-122.784 23.086-48.571 36.773-102.533 39.965-158.816h77.542c14.139 0 25.6-11.461 25.6-25.6s-11.461-25.6-25.6-25.6zM486.4 102.4c98.811 0 179.2 80.389 179.2 179.2 0 10.986-0.99 21.824-2.933 32.458-52.312-37.811-112.885-58.058-176.267-58.058s-123.955 20.246-176.267 58.058c-1.942-10.634-2.933-21.472-2.933-32.458 0-98.811 80.389-179.2 179.2-179.2zM204.8 640c0-173.306 112.678-316.072 256-331.41v662.821c-143.322-15.339-256-158.106-256-331.411zM512 971.411v-662.821c143.322 15.338 256 158.104 256 331.41s-112.678 316.072-256 331.411z"></path></svg> <a href="https://github.com/HeapsIO/heaps.io/issues/new?title=Suggestion:%20Shaders&body=%0A%0ASources:%0A*%20http://heaps.io/documentation/h2d/shaders.html%0A*%20https://github.com/HeapsIO/heaps.io/tree/master/./assets/content/documentation/H2d/Shaders.md" rel="external">Report Suggestion</a></span> </div></div></article> </div></main><footer><div class="container"><div class="lead"><p>Follow <a href="https://github.com/HeapsIO/">Heaps.io on Github</a>: <br/><a class="github-button" href="https://github.com/HeapsIO/heaps/issues" data-icon="octicon-issue-opened" data-style="mega" data-count-api="/repos/HeapsIO/heaps#open_issues_count" data-count-aria-label="# issues on GitHub" aria-label="Issue HeapsIO/heaps on GitHub">Issue</a> &nbsp; <a class="github-button" href="https://github.com/HeapsIO/heaps" data-icon="octicon-star" data-style="mega" data-count-href="/HeapsIO/heaps/stargazers" data-count-api="/repos/HeapsIO/heaps#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star HeapsIO/heaps on GitHub">Star</a></p></div></div></footer><script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" type="text/css" href="https://code.haxe.org/css/highlighter.min.css"/><script defer="defer" src="https://code.haxe.org/js/highlighter.js"></script></body></html>