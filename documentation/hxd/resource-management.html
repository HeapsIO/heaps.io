<!DOCTYPE html>
<html lang="en" id="page"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width"/><title>Resource management - Hxd  - Heaps.io Game Engine</title><base href="./../.."/>
<link href="css/styles.min.css" rel="stylesheet" type="text/css"/><link rel="canonical" href="http://heaps.io/documentation/hxd/resource-management.html"/><link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed:300" rel="stylesheet"/><script src="js/jquery-3.3.1.min.js" type="text/javascript"></script><script src="js/JsTools.js" type="text/javascript"></script><meta name="description" content="Heaps provides a complete asset/resource management framework that can be customized with your own asset packaging system."/>
<meta name="twitter:creator" content="@ncanasse"/>
<meta property="og:title" content="Resource management - Hxd  - Heaps.io Game Engine"/><meta property="og:description" content="Heaps provides a complete asset/resource management framework that can be customized with your own asset packaging system."/><meta property="og:type" content="website"/><meta property="og:url" content="http://heaps.io/documentation/hxd/resource-management.html"/><meta property="og:image" content="http://heaps.io//img/share.png"/>    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en"/></head><body><a href="https://github.com/HeapsIO/" class="fork-button"><img src="img/fork-on-github.png" alt="Fork Heaps on GitHub"/></a><main><header class="header-page"><a class="mobileMenu" href="#"><img src="img/menu.png" alt="Menu"/> </a><nav class="top-nav"><a href="index.html" class="button ">Home</a><a href="about.html" class="button ">About</a><a href="samples/" class="button ">Samples</a><a href="documentation/getting-started/" class="button disabled">Online handbook</a><a href="api/" class="button">API</a><a href="https://gitter.im/heapsio/Lobby" class="button" target="_blank">Community</a></nav><div class="logo"><a href="./"><img src="img/logo.svg"/></a></div></header> <div class="row container"><nav class="col-4 sidebar"><ul class="unstyled"><li><a href="documentation/getting-started/">Getting started</a></li><li><a href="documentation/h2d/">H2d</a></li><li><a href="documentation/h3d/">H3d</a></li><li class="active"><a href="documentation/hxd/">Hxd</a><ul><li class="current"><a href="documentation/hxd/resource-management.html">Resource management</a></li><li><a href="documentation/hxd/sound.html">Sound</a></li></ul></li><li><a href="documentation/shaders/">Shaders</a></li><li><a href="documentation/target-platforms/">Target platforms</a></li><li><a href="documentation/tools/">Tools</a></li></ul></nav><article class="col-8 documentation"><div class="content"><h1><span>Hxd</span> Resource management </h1><p>Heaps provides a complete asset/resource management framework that can be customized with your own asset packaging system.</p>
<h2>Getting Started</h2>
<p>You can directly access your resources in a typed manner in Heaps by using the <code>hxd.Res</code> class, for instance by doing:</p>
<pre class="highlighted">
<span class="mtk5">var</span><span class="mtk1"> </span><span class="mtk17">tile</span><span class="mtk1"> = hxd.</span><span class="mtk9">Res</span><span class="mtk1">.</span><span class="mtk17">myDirectory</span><span class="mtk1">.</span><span class="mtk17">myBitmap</span><span class="mtk1">.</span><span class="mtk10">toTile</span><span class="mtk1">();</span>
</pre>
<p>Please note that this is strictly typed: hxd.Res will look into the <code>res</code> directory of your project (or the directory specified by <code>-D resourcesPath=...</code> haxe compilation parameter). It will then list all directories and files, and depending on the file extension, it will provide you access to the following resources:</p><ul><li><code>png,jpg,jpeg,gif</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Image.hx">hxd.res.Image</a></li><li><code>wav,mp3,ogg</code> : <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Sound.hx">hxd.res.Sound</a></li><li><code>fbx,hmd</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Model.hx">hxd.res.Model</a></li><li><code>fnt</code> (+png): <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/BitmapFont.hx">hxd.res.BitmapFont</a></li><li><code>ttf</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Font.hx">hxd.res.Font</a></li><li><code>tmx</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/TiledMap.hx">hxd.res.TiledMap</a></li><li><code>atlas</code>: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Atlas.hx">hxd.res.Atlas</a></li><li>other: <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Resource.hx">hxd.res.Resource</a> (still allows you to ready binary data)</li></ul>
<h2>Resources loader</h2>
<p>The <code>hxd.Res</code> provides your strictly typed shortcuts to access your resources, but it does not take care of the resource loading. For this, you need to initialize a resource loader before accessing your first resource, for instance:</p>
<pre class="highlighted">
<span class="mtk1">hxd.</span><span class="mtk9">Res</span><span class="mtk1">.</span><span class="mtk10">initEmbed</span><span class="mtk1">();</span>
</pre>
<p>This will be the same as writing:</p>
<pre class="highlighted">
<span class="mtk1">hxd.</span><span class="mtk9">Res</span><span class="mtk1">.</span><span class="mtk17">loader</span><span class="mtk1"> = </span><span class="mtk5">new</span><span class="mtk1"> hxd.res.</span><span class="mtk9">Loader</span><span class="mtk1">(hxd.fs.</span><span class="mtk9">EmbedFileSystem</span><span class="mtk1">.</span><span class="mtk10">create</span><span class="mtk1">());</span>
</pre>
<p>A loader will cache the resources instances after they have been fetched from the underlying file system. There are several ways to store your resources.</p>
<h3>Dynamic resource resolution</h3>
<p>You can resolve a resource from it path in the resource file system by using the following command:</p>
<pre class="highlighted">
<span class="mtk1">hxd.</span><span class="mtk9">Res</span><span class="mtk1">.</span><span class="mtk17">loader</span><span class="mtk1">.</span><span class="mtk10">load</span><span class="mtk1">(</span><span class="mtk7">"path/to/myResource.png"</span><span class="mtk1">)</span>
</pre>
<p>This will return a <a href="https://github.com/ncannasse/heaps/blob/master/hxd/res/Any.hx">hxd.res.Any</a> which have various methods to transform it to other resources.</p>
<h3>Runtime resource loading</h3>
<p>You can also perform you own runtime loading of resources, by using for example <code>hxd.net.BinaryLoader</code>.
Once you have the bytes for your resource, you can use <code>hxd.res.Any.fromBytes</code> to transform it into a proper resource.</p>
<h2>File Systems</h2>
<p>Resources files are accessed through a virtual file system which implements the <a href="https://github.com/ncannasse/heaps/blob/master/hxd/fs/FileSystem.hx">FileSystem</a> interface. </p>
<p>Heaps provides already several file systems, such as:</p><ul><li><a href="https://github.com/ncannasse/heaps/blob/master/hxd/fs/EmbedFileSystem.hx">EmbedFileSystem</a> will gives access to the resources which are embedded with your code (using haxe <code>-resource</code> compilation flag). On platforms such as JavaScript, this allows you to have both your code and assets stored in a single file.</li><li><a href="https://github.com/ncannasse/heaps/blob/master/hxd/fs/LocalFileSystem.hx">LocalFileSystem</a> which gives access to a local file system directory where your resources are stored. This require hard drive access so it is not available in the browser for example.</li><li><a href="https://github.com/ncannasse/heaps/blob/master/hxd/fmt/pak/FileSystem.hx">hxd.fmt.pak.FileSystem</a> will read a <code>.pak</code> file which contains all resources packaged into a single binary. The PAK file can be loaded at runtime and several PAK files can be used, the latest loaded being able to override the resources declared in previously loaded PAK files.  </li></ul>
<p>You can initialize the resource loader and filesystem by yourself, or use one of the following shortcuts:</p><ul><li><code>hxd.Res.initEmbed()</code> for EmbedFileSystem - this will also trigger the embedding of all files present in your resource directory into your code</li><li><code>hxd.Res.initLocal()</code> for LocalFileSystem</li><li><code>hxd.Res.initPak()</code> for PAK FileSystem - this will load res.pak, res1.pak, res2.pak, etc. from the local filesystem - until no file is found.</li></ul>
<h2>Building PAK</h2>
<p>You can build a <code>pak</code> file for all your ressources by running the following command from your project directory:</p>
<pre><code>haxelib run heaps pak</code></pre>
<h2>PAK Loader</h2>
<p>If you want to load your PAK file(s) with a progress bar showing, you can override the <code>loadAssets</code> method of your <code>hxd.App</code> class with the following code:</p>
<pre class="highlighted">
<span class="mtk5">override</span><span class="mtk1"> </span><span class="mtk5">function</span><span class="mtk1"> </span><span class="mtk10">loadAssets</span><span class="mtk1">(</span><span class="mtk17">done</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk5">new</span><span class="mtk1"> hxd.fmt.pak.</span><span class="mtk9">Loader</span><span class="mtk1">(</span><span class="mtk17">s2d</span><span class="mtk1">, </span><span class="mtk17">done</span><span class="mtk1">);</span>
<span class="mtk1">}</span>
</pre>
<p>This will be called before <code>init()</code>, and while loading <code>update()</code> and <code>onResize</code> will not be called.</p><hr/><div class="contribution"><span class="contribution-link"><svg width="16" height="16" viewBox="0 0 1024 1024"><path fill="#222" d="M978.101 45.898c-28.77-28.768-67.018-44.611-107.701-44.611-40.685 0-78.933 15.843-107.701 44.611l-652.8 652.8c-2.645 2.645-4.678 5.837-5.957 9.354l-102.4 281.6c-3.4 9.347-1.077 19.818 5.957 26.85 4.885 4.888 11.43 7.499 18.104 7.499 2.933 0 5.891-0.502 8.744-1.541l281.6-102.4c3.515-1.28 6.709-3.312 9.354-5.958l652.8-652.8c28.768-28.768 44.613-67.018 44.613-107.702s-15.843-78.933-44.613-107.701zM293.114 873.883l-224.709 81.71 81.712-224.707 566.683-566.683 142.997 142.997-566.683 566.683zM941.899 225.098l-45.899 45.899-142.997-142.997 45.899-45.899c19.098-19.098 44.49-29.614 71.498-29.614s52.4 10.518 71.499 29.616c19.098 19.098 29.616 44.49 29.616 71.498s-10.52 52.4-29.616 71.498z"></path></svg><a href="https://github.com/HeapsIO/heaps.io/edit/master/./assets/content/documentation/Hxd/Resource-Management.md?message=Update:%20Resource management&amp;description=%0A%0ASources:%0A*%20http://heaps.io/documentation/hxd/resource-management.html" rel="external">Edit Page</a></span><span class="contribution-link"><svg width="16" height="16" viewBox="0 0 1024 1024"><path fill="#222" d="M896 614.4h-77.544c-3.19-56.282-16.878-110.243-39.965-158.814 53.056-15.624 91.909-64.739 91.909-122.786 0-14.138-11.461-25.6-25.6-25.6s-25.6 11.462-25.6 25.6c0 38.984-29.205 71.254-66.88 76.138-8.928-13.632-18.678-26.68-29.259-39.026-5.515-6.435-11.203-12.6-17.032-18.525 7.147-22.477 10.771-45.877 10.771-69.787 0-127.043-103.357-230.4-230.4-230.4s-230.4 103.357-230.4 230.4c0 23.909 3.624 47.309 10.77 69.787-5.829 5.923-11.515 12.090-17.032 18.525-10.582 12.346-20.331 25.394-29.259 39.026-37.674-4.883-66.878-37.154-66.878-76.138 0-14.138-11.462-25.6-25.6-25.6s-25.6 11.462-25.6 25.6c0 58.046 38.853 107.162 91.907 122.784-23.086 48.573-36.773 102.534-39.965 158.816h-77.542c-14.138 0-25.6 11.461-25.6 25.6s11.462 25.6 25.6 25.6h77.544c3.19 56.283 16.878 110.243 39.965 158.816-53.056 15.622-91.909 64.738-91.909 122.784 0 14.139 11.462 25.6 25.6 25.6s25.6-11.461 25.6-25.6c0-38.984 29.205-71.254 66.88-76.138 8.928 13.632 18.677 26.68 29.259 39.026 62.965 73.458 147.013 113.912 236.661 113.912s173.698-40.454 236.661-113.912c10.581-12.346 20.331-25.394 29.258-39.026 37.677 4.883 66.882 37.152 66.882 76.138 0 14.139 11.461 25.6 25.6 25.6s25.6-11.461 25.6-25.6c0-58.046-38.853-107.163-91.907-122.784 23.086-48.571 36.773-102.533 39.965-158.816h77.542c14.139 0 25.6-11.461 25.6-25.6s-11.461-25.6-25.6-25.6zM486.4 102.4c98.811 0 179.2 80.389 179.2 179.2 0 10.986-0.99 21.824-2.933 32.458-52.312-37.811-112.885-58.058-176.267-58.058s-123.955 20.246-176.267 58.058c-1.942-10.634-2.933-21.472-2.933-32.458 0-98.811 80.389-179.2 179.2-179.2zM204.8 640c0-173.306 112.678-316.072 256-331.41v662.821c-143.322-15.339-256-158.106-256-331.411zM512 971.411v-662.821c143.322 15.338 256 158.104 256 331.41s-112.678 316.072-256 331.411z"></path></svg><a href="https://github.com/HeapsIO/heaps.io/issues/new?title=Suggestion:%20Resource management&amp;body=%0A%0ASources:%0A*%20http://heaps.io/documentation/hxd/resource-management.html%0A*%20https://github.com/HeapsIO/heaps.io/tree/master/./assets/content/documentation/Hxd/Resource-Management.md" rel="external">Report Suggestion</a></span></div></div></article></div></main><footer><div class="container row"><div class="col-5"><a href="./"><img src="img/logo.svg"/></a></div><div class="col-3 links"><h3>Heaps.io</h3><p>Heaps is an open source and multi-platform toolkit to create 2D and 3D games.</p><a href="documentation/getting-started">Download</a><a href="about.html">About</a><a href="api">API</a><a href="https://github.com/HeapsIO/">Contribute</a><a href="https://gitter.im/heapsio/Lobby">Community</a></div><div class="col-1">&nbsp;</div><div class="col-3 links"><h3>Haxe</h3><p>Haxe is an open source and cross-platform language and toolkit.</p><a href="https://www.haxe.org">About</a><a href="https://www.haxe.org/use-cases">Use cases</a><a href="https://haxe.org/documentation/introduction/">Learn</a><a href="https://www.haxe.org/foundation">Haxe foundation</a></div></div><div class="copyright">&copy; 2018 <a href="https://haxe.org/foundation/">Haxe Foundation</a>| <a href="https://github.com/HeapsIO/heaps.io/tree/master/./assets/content/documentation/Hxd/Resource-Management.md">Contribute to this page</a>| <a href="https://feathericons.com/" rel="nofollow">Feather open source icons</a></div></footer><script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" type="text/css" href="https://code.haxe.org/css/highlighter.min.css"/><script defer="defer" src="https://code.haxe.org/js/highlighter.js"></script></body></html>